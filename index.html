<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>THIS IS US — Library</title>

  <style>
    :root{
      --bg:#070A12; --card:#0E1426; --text:#EAF0FF; --muted:#9FB0D6;
      --stroke:rgba(255,255,255,.10); --shadow: 0 20px 70px rgba(0,0,0,.55);
      --accent:#7C5CFF;
    }
    [data-theme="light"]{
      --bg:#F7F8FB; --card:#FFFFFF; --text:#0F172A; --muted:#475569;
      --stroke:rgba(2,6,23,.10); --shadow: 0 18px 60px rgba(2,6,23,.12);
      --accent:#5B5CFF;
    }
    *{box-sizing:border-box}
    body{
      margin:0; min-height:100vh;
      background: radial-gradient(1200px 900px at 20% 10%, rgba(124,92,255,.35), transparent 60%),
                  radial-gradient(900px 700px at 80% 30%, rgba(55,195,255,.18), transparent 60%),
                  var(--bg);
      color:var(--text);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto;
    }
    .wrap{max-width:1100px;margin:0 auto;padding:22px 18px 40px}
    .topbar{
      display:flex; align-items:center; justify-content:space-between; gap:12px;
      border:1px solid var(--stroke); background:rgba(255,255,255,.03);
      backdrop-filter: blur(10px);
      padding:14px 14px; border-radius:16px;
    }
    .brand{display:flex;flex-direction:column;line-height:1.1}
    .brand b{letter-spacing:.18em;font-size:12px;color:var(--muted)}
    .brand h1{margin:4px 0 0;font-size:18px}
    .actions{display:flex; gap:10px; flex-wrap:wrap; justify-content:flex-end}
    .btn{
      border:1px solid var(--stroke);
      background:rgba(255,255,255,.04);
      color:var(--text);
      padding:10px 12px;
      border-radius:999px;
      cursor:pointer;
      transition:.18s;
      font-weight:600;
      font-size:13px;
    }
    .btn:hover{transform:translateY(-1px); border-color:rgba(124,92,255,.45)}
    .btn.primary{
      background:linear-gradient(135deg, rgba(124,92,255,.95), rgba(55,195,255,.75));
      border-color:transparent;
      box-shadow: 0 18px 55px rgba(124,92,255,.22);
    }
    .hero{
      margin-top:18px;
      border:1px solid var(--stroke);
      background:linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
      border-radius:22px;
      padding:22px;
      box-shadow:var(--shadow);
      display:grid;
      grid-template-columns: 1.35fr .65fr;
      gap:16px;
      align-items:center;
    }
    .hero h2{margin:0 0 8px;font-size:28px}
    .hero p{margin:0;color:var(--muted);max-width:60ch;line-height:1.55}
    .status{margin-top:12px;display:flex; gap:10px; flex-wrap:wrap; align-items:center;color:var(--muted);font-size:13px}
    .pill{border:1px solid var(--stroke);background:rgba(255,255,255,.03);padding:8px 10px;border-radius:999px}
    .shelfTitle{margin:22px 2px 10px; color:var(--muted); font-size:13px; letter-spacing:.14em; text-transform:uppercase}
    .grid{display:grid;grid-template-columns: repeat(12, 1fr);gap:16px}
    .bookCard{
      grid-column: span 6;
      border:1px solid var(--stroke);
      border-radius:22px;
      background:linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
      box-shadow:var(--shadow);
      overflow:hidden;
      position:relative;
      transition:.18s;
      min-height:290px;
      display:grid;
      grid-template-columns: 1fr 1.1fr;
    }
    .bookCard:hover{transform:translateY(-2px)}
    .coverZone{
      position:relative;
      background:radial-gradient(700px 300px at 30% 20%, rgba(124,92,255,.25), transparent 60%);
      display:flex; align-items:center; justify-content:center;
      padding:18px;
    }
    .book3d{
      width:min(220px, 42vw);
      aspect-ratio: 2/3;
      position:relative;
      transform-style:preserve-3d;
      transform: perspective(900px) rotateY(-12deg);
      transition:.25s;
    }
    .bookCard:hover .book3d{transform: perspective(900px) rotateY(-2deg) translateY(-3px)}
    .bookFace{position:absolute; inset:0;border-radius:14px;overflow:hidden;box-shadow:0 18px 40px rgba(0,0,0,.35);border:1px solid rgba(255,255,255,.10);background:#111}
    .bookFace img{width:100%;height:100%;object-fit:cover;display:block}
    .meta{padding:18px 18px 16px;display:flex;flex-direction:column;gap:10px}
    .meta h3{margin:0;font-size:18px}
    .meta p{margin:0;color:var(--muted);line-height:1.55}
    .meta .row{display:flex; gap:10px; flex-wrap:wrap; margin-top:auto}
    .small{font-size:12px;color:var(--muted)}
    @media (max-width:820px){.hero{grid-template-columns:1fr}.bookCard{grid-column: span 12; grid-template-columns: 1fr 1fr}}
    @media (max-width:560px){.bookCard{grid-template-columns:1fr}.book3d{width:min(240px, 78vw)}}
  </style>
</head>

<body>
  <div class="wrap">
    <div class="topbar">
      <div class="brand">
        <b>ONLINE NOVEL SERIES</b>
        <h1>THIS IS US — by Shengbe Koker</h1>
      </div>
      <div class="actions">
        <button class="btn" id="themeBtn">Toggle Theme</button>
        <button class="btn" id="signupBtn">Create Account</button>
        <button class="btn" id="loginBtn">Sign In</button>
        <button class="btn" id="logoutBtn">Sign Out</button>
      </div>
    </div>

    <section class="hero">
      <div>
        <h2>Read in guest mode — or sync your progress.</h2>
        <p>
          You can read freely without an account. If you want your reading progress, rewards, and ratings saved across devices,
          create an account and sign in.
        </p>
        <div class="status">
          <span class="pill" id="statusPill">Loading…</span>
          <span class="pill" id="syncPill">Sync: …</span>
          <span class="pill">© <span id="year"></span> Shengbe Koker</span>
        </div>
      </div>
      <div class="small">
        <div class="pill">Guest mode saves locally on this device only.</div>
      </div>
    </section>

    <div class="shelfTitle">Library</div>

    <div class="grid">
      <div class="bookCard">
        <div class="coverZone">
          <div class="book3d">
            <div class="bookFace">
              <img src="assets/cover-book1.png" alt="THIS IS US — Book I cover">
            </div>
          </div>
        </div>
        <div class="meta">
          <div class="small">BOOK I</div>
          <h3>Where We Began</h3>
          <p>Flip pages, audio read-aloud, and progress save. Read now as a guest.</p>
          <div class="row">
            <button class="btn primary" id="readBtn">Read Now</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script type="module">
    import { firebaseConfig } from "./firebase-config.js";
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
    import {
      getAuth, onAuthStateChanged,
      createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut
    } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-auth.js";

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);

    // Theme
    const savedTheme = localStorage.getItem("theme") || "dark";
    document.documentElement.dataset.theme = savedTheme === "light" ? "light" : "dark";
    document.getElementById("themeBtn").onclick = ()=>{
      const next = (document.documentElement.dataset.theme === "light") ? "dark" : "light";
      document.documentElement.dataset.theme = next;
      localStorage.setItem("theme", next);
    };
    document.getElementById("year").textContent = new Date().getFullYear();

    const statusPill = document.getElementById("statusPill");
    const syncPill = document.getElementById("syncPill");

    onAuthStateChanged(auth, (user)=>{
      if(user){
        statusPill.textContent = `Signed in: ${user.email}`;
        syncPill.textContent = "Sync: ON (cloud + device)";
      }else{
        statusPill.textContent = "Guest mode (not signed in)";
        syncPill.textContent = "Sync: OFF (device only)";
      }
    });

    document.getElementById("signupBtn").onclick = async ()=>{
      const email = prompt("Email:");
      const pass = prompt("Password (6+ chars):");
      try{ await createUserWithEmailAndPassword(auth, email, pass); alert("Account created ✅"); }
      catch(e){ alert(e.message); }
    };

    document.getElementById("loginBtn").onclick = async ()=>{
      const email = prompt("Email:");
      const pass = prompt("Password:");
      try{ await signInWithEmailAndPassword(auth, email, pass); alert("Signed in ✅"); }
      catch(e){ alert(e.message); }
    };

    document.getElementById("logoutBtn").onclick = async ()=>{
      await signOut(auth);
      alert("Signed out ✅");
    };

    // Always allow reading
    document.getElementById("readBtn").onclick = ()=>{
      location.href = "./read.html?book=book1";
    };
  </script>
</body>
</html>
